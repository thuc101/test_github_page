"use strict";(self["webpackChunkvue_start_1"]=self["webpackChunkvue_start_1"]||[]).push([[3308],{33308:function(r,e,n){n.r(e),n.d(e,{default:function(){return u}});var t=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",[t("raw-loader",{attrs:{mytxt:n(85275).Z}}),t("h1",[r._v("This is KonvaVue")]),t("b-row",[t("b-col",{staticClass:"border-right",attrs:{sm:"3"}},[t("div",{staticClass:"mb-1"}),t("div",{attrs:{id:"stage-parent"}},[t("div",{staticClass:"border",attrs:{id:"container"}},[t("v-stage",{ref:"stage",attrs:{config:r.configKonva},on:{click:r.onStageClick,mousemove:r.onStageMouseMove,mouseenter:r.onStageMouseenter,mouseleave:r.onStageMouseleave}},[t("v-layer",{ref:"layer"},[t("v-group",{ref:"group3",attrs:{config:{x:900,y:55,draggable:!0}},on:{click:r.onGroup3Click,dragend:r.onGroup3Dragend,mousemove:r.onGroup3move}},[t("v-rect",{ref:"main3",attrs:{config:{x:0,y:0,width:500,height:600,fill:"white",stroke:"blue",name:"main"}}}),t("v-circle",{ref:"circle3",attrs:{config:{x:100,y:100,dx:2,dy:2,radius:30,fill:"yellow",stroke:"black",strokeWidth:5,draggable:!0,visible:!0}}}),t("v-rect",{ref:"left3",attrs:{config:{x:10,y:10,dx:2,dy:2,width:50,height:50,fill:"green",stroke:"blue",draggable:!0,name:"left"}}}),t("v-rect",{ref:"right3",attrs:{config:{x:440,y:540,width:50,height:50,fill:"green",stroke:"blue",draggable:!0,name:"right"}}})],1)],1)],1)],1)])]),t("b-col",{attrs:{sm:"9"}},[r._v(" "+r._s(r.msg)),t("br")])],1)],1)},a=[],i=1500,o=1e3,s=null,l=null,g={name:"Tpl",components:{},computed:{},data(){return{msg:"hello",configKonva:{width:i,height:o},configCircle:{x:i/2,y:o/2,radius:90,fill:"yellow",stroke:"black",strokeWidth:5,draggable:!0,visible:!1},arColor:["blue","red","yellow"]}},mounted(){this.$nextTick((function(){l=this.$refs.layer.getNode(),s=this.$refs.stage.getNode(),window.addEventListener("resize",this.fitStageIntoParentContainer),this.fitStageIntoParentContainer();let r=this.createAnimate3();r.start()}))},created(){},methods:{onGroup3Dragend(r){this.msg={p:{x:Math.floor(r.target.x()),y:Math.floor(r.target.y())}}},onGroup3Click(){let r=this.myGetMouse(),e=this.$refs.group3.getNode(),n={x:e.x(),y:e.y()},t={x:r.x-n.x,y:r.y-n.y};this.msg={p3:t};let a=this.$refs.circle3.getNode().clone();a.x(t.x),a.y(t.y),a.name("circle3"),a.setAttr("dx",2),a.setAttr("dy",2),e.add(a);let i=l.find(".circle3").length;a.fill(this.arColor[i%3])},onGroup3move(r){let e=this.myGetMouse(),n=this.$refs.group3.getNode(),t={x:n.x(),y:n.y()},a={x:e.x-t.x,y:e.y-t.y};this.msg={p3:a}},circle3Move(r){let e=r.getAttr("dx"),n=r.getAttr("dy");r.x(r.x()+e),r.y(r.y()+n)},circle3ChamDung(r){let e=this.$refs.main3.getNode(),n=e.width(),t=(e.height(),Math.abs(n-(r.x()+r.radius())));return r.x()<0||t<r.radius()},circle3ChamNgang(r){let e=this.$refs.main3.getNode(),n=(e.width(),e.height()),t=n-(r.y()+r.radius());return r.y()<0||t<r.radius()},createAnimate3(){let r=this;var e=new Konva.Animation((function(e){let n=l.find(".circle3");n.forEach((e=>{if(r.circle3Move(e),1==r.circle3ChamDung(e)){let n=e.getAttr("dx");e.setAttr("dx",-1*n),r.circle3Move(e)}if(1==r.circle3ChamNgang(e)){let n=e.getAttr("dy");e.setAttr("dy",-1*n),r.circle3Move(e)}}))}),l);return e},onStageClick(r){},onStageMouseMove(r){},onStageMouseenter(r){},onStageMouseleave(r){},myGetMouse(){let r=s.scale().x;var e=s.getPointerPosition(),n=e.x,t=e.y,a=Math.round(n/r),i=Math.round(t/r);return{x:a,y:i}},fitStageIntoParentContainer(){var r=document.querySelector("#stage-parent"),e=r.offsetWidth,n=e/i;s.width(i*n),s.height(o*n),s.scale({x:n,y:n}),this.configKonva.width=i*n,this.configKonva.height=o*n}}},c=g,d=n(1001),h=(0,d.Z)(c,t,a,!1,null,"ab5aa9ee",null),u=h.exports},85275:function(r,e){e["Z"]='<template>\r\n  <div>\r\n    <raw-loader :mytxt=" require(\'!raw-loader!./KonvaVueGroup2.vue\').default "></raw-loader> \r\n    <h1>This is KonvaVue</h1>\r\n    <b-row>\r\n      <b-col sm="3" class="border-right">\r\n        <div class="mb-1">\r\n        </div>\r\n          <div id="stage-parent">\r\n            <div id="container" class="border">\r\n                <v-stage ref="stage"\r\n                    @click="onStageClick"\r\n                    @mousemove="onStageMouseMove" \r\n                    @mouseenter="onStageMouseenter"\r\n                    @mouseleave="onStageMouseleave"\r\n                    :config="configKonva" >\r\n                    <v-layer ref="layer">\r\n\r\n                      <v-group ref="group3"\r\n                        @click="onGroup3Click"\r\n                        @dragend="onGroup3Dragend"\r\n                        @mousemove="onGroup3move"\r\n                        :config="{\r\n                          x: 900,\r\n                          y: 55,\r\n                          draggable: true\r\n                        }"\r\n                      >\r\n                        <v-rect ref="main3"\r\n                          :config="{\r\n                            x: 0,\r\n                            y: 0,\r\n                            width: 500,\r\n                            height: 600,\r\n                            fill: \'white\',\r\n                            stroke:\'blue\',\r\n                            //shadowBlur: 10,\r\n                            name:\'main\'\r\n                          }"\r\n                        />\r\n                        <v-circle ref="circle3" :config="{\r\n                          x: 100,\r\n                          y: 100,\r\n                          dx:2,\r\n                          dy:2,\r\n                          radius: 30,\r\n                          fill: \'yellow\',\r\n                          stroke: \'black\',\r\n                          strokeWidth: 5,\r\n                          draggable:true,\r\n                          visible:true,\r\n                          \r\n                        }">\r\n                        </v-circle>\r\n\r\n\r\n                        <v-rect ref="left3"\r\n                          :config="{\r\n                            x: 10,\r\n                            y: 10,\r\n                            dx:2,\r\n                            dy:2,\r\n                            width: 50,\r\n                            height: 50,\r\n                            fill: \'green\',\r\n                            stroke:\'blue\',\r\n                            //shadowBlur: 10,\r\n                            draggable:true,\r\n                            name:\'left\'\r\n                          }"\r\n                        />\r\n                        <v-rect ref="right3"\r\n                          :config="{\r\n                            x: 500-60,\r\n                            y: 600-60,\r\n                            width: 50,\r\n                            height: 50,\r\n                            fill: \'green\',\r\n                            stroke:\'blue\',\r\n                            //shadowBlur: 10,\r\n                            draggable:true,\r\n                            name:\'right\'\r\n                          }"\r\n                        />\r\n                      </v-group>\r\n                    </v-layer>\r\n                </v-stage>\r\n            </div>\r\n          </div>\r\n\r\n      </b-col>\r\n      <b-col sm="9">\r\n        {{msg}}<br>\r\n      </b-col>\r\n    </b-row>\r\n  </div>\r\n</template>\r\n<script>\r\nvar sceneWidth = 1500;\r\nvar sceneHeight = 1000;\r\nvar stage=null;\r\nvar layer=null;\r\nexport default {\r\n  name: \'Tpl\',\r\n  components: {\r\n  },\r\n  computed: {\r\n  },\r\n  data(){\r\n    return{\r\n        msg:"hello",\r\n        configKonva: {\r\n          width: sceneWidth,\r\n          height: sceneHeight\r\n        },\r\n        configCircle: {\r\n          x: sceneWidth/2,\r\n          y: sceneHeight/2,\r\n          radius: 90,\r\n          fill: "yellow",\r\n          stroke: "black",\r\n          strokeWidth: 5,\r\n          draggable:true,\r\n          visible:false,\r\n        },\r\n        arColor:[\'blue\',\'red\',\'yellow\'],\r\n    }\r\n  },\r\n  mounted(){\r\n    this.$nextTick(function(){\r\n      layer=this.$refs.layer.getNode();\r\n      stage=this.$refs.stage.getNode();\r\n      window.addEventListener("resize", this.fitStageIntoParentContainer);\r\n      this.fitStageIntoParentContainer();\r\n      let animate=this.createAnimate3();\r\n      animate.start();\r\n    })\r\n  },\r\n  created(){\r\n  },\r\n  methods:{\r\n\r\n    onGroup3Dragend(e){\r\n      this.msg={\r\n        p:{x:Math.floor(e.target.x()),y:Math.floor(e.target.y())}\r\n      }\r\n    },\r\n    onGroup3Click(){\r\n      let p1=this.myGetMouse();\r\n      let g=this.$refs.group3.getNode();\r\n      let p2={x:g.x(),y:g.y()};\r\n      let p3={\r\n        x:p1.x-p2.x,\r\n        y:p1.y-p2.y\r\n      }\r\n      this.msg={\r\n        p3:p3\r\n      }\r\n      let l=this.$refs.circle3.getNode().clone();\r\n      l.x(p3.x);\r\n      l.y(p3.y);\r\n      l.name(\'circle3\');\r\n      l.setAttr("dx",2);\r\n      l.setAttr("dy",2);\r\n      g.add(l);\r\n      let len=layer.find(\'.circle3\').length;\r\n      l.fill(this.arColor[len%3]);\r\n\r\n    },   \r\n    onGroup3move(e){\r\n      let p1=this.myGetMouse();\r\n      let g=this.$refs.group3.getNode();\r\n      let p2={x:g.x(),y:g.y()};\r\n      let p3={\r\n        x:p1.x-p2.x,\r\n        y:p1.y-p2.y\r\n      }\r\n      this.msg={\r\n        p3:p3\r\n      }\r\n    },    \r\n    circle3Move(s){\r\n      let dx=s.getAttr("dx");\r\n      let dy=s.getAttr("dy");\r\n      s.x( s.x() + dx );\r\n      s.y( s.y() + dy );\r\n    },\r\n    circle3ChamDung(s){\r\n      let m=this.$refs.main3.getNode();\r\n      let w=m.width();\r\n      let h=m.height();\r\n      let d= Math.abs(w-(s.x()+s.radius()));\r\n      return (s.x() < 0 || d < s.radius());\r\n    },\r\n    circle3ChamNgang(s){\r\n      let m=this.$refs.main3.getNode();\r\n      let w=m.width();\r\n      let h=m.height();\r\n      let d=h-(s.y()+s.radius());\r\n      return (s.y() < 0 || d<s.radius());\r\n    },\r\n    createAnimate3(){\r\n      let that=this;\r\n      var anim = new Konva.Animation(function (frame) {\r\n        let list=layer.find(\'.circle3\');\r\n        //that.msg=list.length;\r\n        list.forEach((x)=>{\r\n          that.circle3Move(x);\r\n          if(that.circle3ChamDung(x)==true){\r\n            let dx=x.getAttr("dx");\r\n            x.setAttr("dx",(-1)*dx);\r\n            that.circle3Move(x);\r\n          }\r\n          if(that.circle3ChamNgang(x)==true){\r\n            let dy=x.getAttr("dy");\r\n            x.setAttr("dy",(-1)*dy);\r\n            that.circle3Move(x);\r\n          }\r\n\r\n        })\r\n      }, layer);\r\n      return anim;\r\n    },\r\n\r\n\r\n\r\n    onStageClick(e){\r\n    },\r\n    onStageMouseMove(e){\r\n    },\r\n    onStageMouseenter(e){\r\n    },\r\n    onStageMouseleave(e){\r\n    },\r\n    myGetMouse() {\r\n      let scale=stage.scale().x;\r\n      var mousePos = stage.getPointerPosition();\r\n      var x = mousePos.x;\r\n      var y = mousePos.y;\r\n      var xx = Math.round(x / scale);\r\n      var yy = Math.round(y / scale);\r\n      return { x: xx, y: yy };\r\n    },\r\n    fitStageIntoParentContainer() {\r\n      var container = document.querySelector(\'#stage-parent\');\r\n      var containerWidth = container.offsetWidth;\r\n      var scale = containerWidth / sceneWidth;\r\n      stage.width(sceneWidth * scale);\r\n      stage.height(sceneHeight * scale);\r\n      stage.scale({ x: scale, y: scale });\r\n      this.configKonva.width = sceneWidth * scale;\r\n      this.configKonva.height = sceneHeight * scale;\r\n    },\r\n  }\r\n}\r\n<\/script>\r\n<style scoped>\r\n</style>\r\n'}}]);
//# sourceMappingURL=3308.a47d1ec8.js.map