(self["webpackChunkvue_start_1"]=self["webpackChunkvue_start_1"]||[]).push([[4535],{54535:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MonHocToan"},[a("raw-loader",{attrs:{mytxt:n(61808).Z}}),a("b-container",{attrs:{fluid:""}},[a("form",{on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.onSave.apply(null,arguments)}}},[a("b-table",{ref:"mytable",attrs:{"thead-class":"myTable",items:e.myProvider,fields:e.fields,"current-page":e.currentPage,"per-page":e.perPage,filter:e.filter,"filter-included-fields":e.filterOn,"sort-by":e.sortBy,"sort-desc":e.sortDesc,"sort-direction":e.sortDirection,stacked:"sm","show-empty":"",small:"",fixed:"",outlined:"",bordered:""},on:{"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t},filtered:e.onFiltered},scopedSlots:e._u([{key:"cell()",fn:function(t){var n=t.value,i=t.item,r=t.field.key;return[e.sel[e.pri]!=i[e.pri]?[0!=i[e.pri]?[r==e.pri?[e._v(" "+e._s(n)+" ")]:e._e(),"HinhAnh"==r?[a("img",{attrs:{src:"/api/FileUpload/GetImage/"+i[r],width:"50",height:"30"}})]:e._e(),"Ten"==r?[e._v(" "+e._s(n)+" ")]:e._e(),"NgayMua"==r?[e._v(" "+e._s(n)+" ")]:e._e(),"GiaTien"==r?[e._v(" "+e._s(n)+" ")]:e._e()]:e._e()]:e._e(),e.sel[e.pri]==i[e.pri]||0==i[e.pri]?["Id"==r?[a("span",[e._v(e._s(n))])]:e._e(),"HinhAnh"==r?[a("com-upload-2",{ref:"HinhAnh",attrs:{src:"/api/FileUpload/GetImage/"+i[r]}})]:e._e(),"Ten"==r?[a("b-form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"ko-hop-le":e.errors.has(r)},attrs:{name:r,placeholder:""},model:{value:i[r],callback:function(t){e.$set(i,r,t)},expression:"item[key]"}})]:e._e(),"NgayMua"==r?[a("b-form-datepicker",{staticClass:"mb-2",attrs:{"date-format-options":{year:"numeric",month:"numeric",day:"numeric"},locale:"vi"},model:{value:i[r],callback:function(t){e.$set(i,r,t)},expression:"item[key]"}})]:e._e(),"GiaTien"==r?[a("b-form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"text-right":!0,"ko-hop-le":e.errors.has(r)},attrs:{name:r,placeholder:""},model:{value:i[r],callback:function(t){e.$set(i,r,t)},expression:"item[key]"}})]:e._e()]:e._e()]}},{key:"cell(cmd)",fn:function(t){return[0==t.item[e.pri]?[a("b-button",{staticClass:"mr-1",attrs:{size:"sm"},on:{click:function(n){return e.onSave(t.item)}}},[a("b-icon-hand-thumbs-up")],1),a("b-button",{staticClass:"mr-1",attrs:{size:"sm"},on:{click:function(n){return e.OnCancel(t.item)}}},[a("b-icon-file-x")],1)]:[e.sel[e.pri]!=t.item[e.pri]?a("b-button",{staticClass:"mr-1",attrs:{variant:"outline",size:"sm"},on:{click:function(n){return e.OnEdit(t.item)}}},[a("b-icon-pencil-square")],1):e._e(),e.sel[e.pri]!=t.item[e.pri]?a("b-button",{staticClass:"mr-1",attrs:{variant:"outline",size:"sm"},on:{click:function(n){return e.OnDel(t.item)}}},[a("b-icon-trash")],1):e._e(),e.sel[e.pri]==t.item[e.pri]?a("b-button",{staticClass:"mr-1",attrs:{variant:"outline",size:"sm"},on:{click:function(n){return e.onSave(t.item)}}},[a("b-icon-hand-thumbs-up")],1):e._e(),e.sel[e.pri]==t.item[e.pri]?a("b-button",{staticClass:"mr-1",attrs:{variant:"outline",size:"sm"},on:{click:function(n){return e.OnCancel(t.item)}}},[a("b-icon-file-x")],1):e._e()]]}},{key:"bottom-row",fn:function(t){return[a("td",{attrs:{colspan:t.columns}},[a("b-row",[a("b-col",{staticClass:"my-1",attrs:{sm:"6"}},[a("b-form-group",{staticClass:"mb-0",attrs:{label:"Tìm kiếm","label-for":"filter-input","label-cols-sm":"3","label-align-sm":"right","label-size":"sm"}},[a("b-input-group",{attrs:{size:"sm"}},[a("b-form-input",{attrs:{id:"filter-input",type:"search",placeholder:"Type to Search"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}),a("b-input-group-append",[a("b-button",{attrs:{disabled:!e.filter},on:{click:function(t){e.filter=""}}},[e._v("Clear")])],1)],1)],1)],1),a("b-col",{staticClass:"my-1",attrs:{sm:"6"}},[a("b-form-group",{staticClass:"mb-0",attrs:{label:"Số dòng","label-for":"per-page-select","label-cols-sm":"6","label-cols-md":"4","label-cols-lg":"3","label-align-sm":"right","label-size":"sm"}},[a("b-form-select",{attrs:{id:"per-page-select",options:e.pageOptions,size:"sm"},model:{value:e.perPage,callback:function(t){e.perPage=t},expression:"perPage"}})],1)],1),a("b-col",{staticClass:"my-1 text-right",attrs:{sm:"6"}},[a("span",[e._v("page : "+e._s(e.currentPage)+" / "+e._s(e.last_page)+" of "+e._s(e.totalRows)+" ")]),a("b-button",{staticClass:"mr-1 mb-1",attrs:{disabled:1==e.adding||1==e.isEditing(),size:"sm"},on:{click:e.OnAdd}},[a("b",[e._v("Add")])])],1),a("b-col",{staticClass:"my-1",attrs:{sm:"6"}},[a("b-pagination",{ref:"mypage",attrs:{"total-rows":e.totalRows,"per-page":e.perPage,size:"sm",align:"fill","first-text":"First","prev-text":"Prev","next-text":"Next","last-text":"Last"},on:{change:e.onChangePage,input:e.onPagingInput},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1)],1)],1)]}},{key:"row-details",fn:function(t){return[a("b-card",[a("ul",e._l(t.item,(function(t,n){return a("li",{key:n},[e._v(e._s(n)+": "+e._s(t))])})),0)])]}}])})],1),a("b-modal",{attrs:{id:e.infoModal.id,title:e.infoModal.title,"ok-only":""},on:{hide:e.resetInfoModal}},[a("pre",[e._v(e._s(e.infoModal.content))])])],1)],1)},i=[],r=n(77673),s=n(16198),l=(n(92222),n(57327),n(41539),n(54747),n(47941),n(38862),n(34553),n(40561),n(12954)),o=n(20144),c=n(9669),u=n.n(c),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[n("form",{attrs:{enctype:"multipart/form-data"},on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.onUpload.apply(null,arguments)}}},[n("img",{ref:"outImage",staticClass:"mb-1",attrs:{width:"90",height:"50"}}),n("br"),n("input",{ref:"file",staticClass:"m-1",attrs:{type:"file",id:"file",accept:"image/png, image/gif, image/jpeg"},on:{change:e.onFileChange}}),n("br")])])},m=[],p=(n(68309),n(19755)),f=n.n(p),h=function(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}}))},g={name:"HelloWorld",props:["msg","src"],mounted:function(){f()(this.$refs.outImage).attr("src",this.src)},methods:{onUpload:function(){var e=this.getFile();""!=e&&alert(e.name)},getFile:function(){var e=this.$refs.file.files,t=0==e.length?"":e[0];return t},onFileChange:function(){var e=this,t=this.getFile();h(t).then((function(t){f()(e.$refs.outImage).attr("src",t)}))},OnRemove:function(){f()(this.$refs.outImage).attr("src",""),f()(this.$refs.file).val("")}}},b=g,y=n(1001),v=(0,y.Z)(b,d,m,!1,null,null,null),k=v.exports,x=n(30381),w=n.n(x);o["default"].use(l.ZP,{classes:!0,fieldsBagName:"veeFields"});var C={components:{ComUpload2:k},data:function(){return{items:[],fields:[{key:"Id",formatter:function(e,t,n){return e},sortable:!0,thClass:"text-center",tdClass:"text-center align-middle",thStyle:{width:"10%"}},{key:"HinhAnh",label:"Hình",sortable:!0,thClass:"text-center",tdClass:"align-middle text-center",thStyle:{width:"20%"}},{key:"Ten",label:"Tên thiết bị",sortable:!0,thClass:"text-center",tdClass:"align-middle",thStyle:{width:"35%"}},{key:"NgayMua",label:"Ngày mua",formatter:function(e,t,n){return w()(e).format("DD/MM/YYYY")},sortable:!0,thClass:"text-center",tdClass:"align-middle text-center",thStyle:{width:"15%"}},{key:"GiaTien",label:"Giá tiền",formatter:function(e,t,n){return parseInt(e).toLocaleString()},sortable:!0,thClass:"text-center",tdClass:"align-middle text-right",thStyle:{width:"10%"}},{key:"cmd",class:"text-center",thClass:"text-center",tdClass:"align-middle",thStyle:{width:"10%"}}],totalRows:1,currentPage:1,perPage:5,pageOptions:[5,10,15,{value:100,text:"Show a lot"}],sortBy:"",sortDesc:!1,sortDirection:"asc",filter:null,filterOn:[],infoModal:{id:"info-modal",title:"",content:""},sel:{},pri:"Id",last_page:0,adding:!1}},watch:{last_page:function(e,t){},currentPage:function(e){},totalRows:function(e,t){}},computed:{},mounted:function(){},methods:{onPagingInput:function(){},myProvider:function(e){var t=this,n=e.currentPage,a=e.perPage,i=e.sortBy,r=e.sortDesc,s=this,l="/api/ThietBi/GetPage2";if(l="".concat(l,"?page=").concat(n,"&size=").concat(a,"&sortBy=").concat(i,"&sortDesc=").concat(r),e.filter){var o=e.filter;l="".concat(l,"&filter=").concat(o)}return u().get(l).then((function(e){if(s.last_page=e.data.last_page,s.totalRows=e.data.rowCount,1==t.adding){var n={};n[t.pri]=0,n["Ten"]="",n["HinhAnh"]="no_img.png",n["NgayMua"]=new Date,n["GiaTien"]=1e3,e.data.data.unshift(n)}return s.mapData(e.data.data)}))},mapData:function(e){var t=[];return e.forEach((function(e){var n={};Object.keys(e).forEach((function(t){var a=t;n[a]=e[t]})),t.push(n)})),t},onChangePage:function(){this.sel={},this.adding=!1},OnAdd:function(){this.adding=!0,this.$refs.mytable.refresh()},OnEdit:function(e){"{}"==JSON.stringify(this.sel)&&1!=this.adding&&(this.sel=JSON.parse(JSON.stringify(e)))},onSave:function(e){var t=this;this.$validator.validateAll().then((function(n){if(n){var a=JSON.parse(JSON.stringify(e)),i=t.$refs.HinhAnh.getFile(),r=new FormData;r.append("Id",a.Id),r.append("Ten",a.Ten),r.append("HinhAnh",a.HinhAnh),r.append("NgayMua",a.NgayMua),r.append("GiaTien",a.GiaTien),r.append("File",i);var s=t;f().ajax({url:"/api/ThietBi/Save3",data:r,processData:!1,contentType:!1,type:"POST",success:function(t){alert(JSON.stringify(t)),0==e.pri||(s.sel={}),s.toast("".concat(t.msg)),s.adding=!1,s.$refs.mytable.refresh()}})}else t.toast("Không hợp lệ")}))},OnCancel:function(e){0!=e[this.pri]?(this.doCancel(e),this.sel={}):(this.adding=!1,this.$refs.mytable.refresh())},OnDel:function(e){var t=this;this.Del(e[this.pri]).then((function(e){if("ok"==e.data.kq){t.toast("".concat(e.data.msg));var n=t.getLastPage(t.totalRows-1);n<t.currentPage&&(t.currentPage=n),t.$refs.mytable.refresh()}}))},delRow:function(e){var t=e.id,n=this.items.findIndex((function(e){return e.id==t}));this.items.splice(n,1)},isEditing:function(){return"{}"!=JSON.stringify(this.sel)},isAdded:function(){var e=!1;return this.items.forEach((function(t){0==t.id&&(e=!0)})),e},doCancel:function(e){for(var t in e)e[t]!=this.sel[t]&&(e[t]=this.sel[t])},getLastPage:function(e){var t=this.perPage,n=e%t;return 0==n?e/t:(e-n)/t+1},gotoPage:function(e){this.currentPage=e,this.$refs.mytable.refresh()},toast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.$bvToast.toast(e,{title:"Information",variant:t,solid:!0})},Save:function(e){return(0,s.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u().post("/api/Ban/Save",e).catch((function(e){console.log(e)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},Del:function(e){return(0,s.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u().get("/api/ThietBi/Delete?id=".concat(e)).catch((function(e){console.log(e)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},getById:function(e){return(0,s.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u().get("/api/Ban/GetById?id=".concat(e)).catch((function(e){console.log(e)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},GetCombo:function(){return(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u().get("/api/Ban/GetCombo").catch((function(e){console.log(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},info:function(e,t,n){this.infoModal.title="Row index: ".concat(t),this.infoModal.content=JSON.stringify(e,null,2),this.$root.$emit("bv::show::modal",this.infoModal.id,n)},resetInfoModal:function(){this.infoModal.title="",this.infoModal.content=""},onFiltered:function(e){this.totalRows=e.length,this.currentPage=1}}},P=C,S=(0,y.Z)(P,a,i,!1,null,null,null),_=S.exports},92222:function(e,t,n){"use strict";var a=n(82109),i=n(17854),r=n(47293),s=n(43157),l=n(70111),o=n(47908),c=n(26244),u=n(86135),d=n(65417),m=n(81194),p=n(5112),f=n(7392),h=p("isConcatSpreadable"),g=9007199254740991,b="Maximum allowed index exceeded",y=i.TypeError,v=f>=51||!r((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),k=m("concat"),x=function(e){if(!l(e))return!1;var t=e[h];return void 0!==t?!!t:s(e)},w=!v||!k;a({target:"Array",proto:!0,arity:1,forced:w},{concat:function(e){var t,n,a,i,r,s=o(this),l=d(s,0),m=0;for(t=-1,a=arguments.length;t<a;t++)if(r=-1===t?s:arguments[t],x(r)){if(i=c(r),m+i>g)throw y(b);for(n=0;n<i;n++,m++)n in r&&u(l,m,r[n])}else{if(m>=g)throw y(b);u(l,m++,r)}return l.length=m,l}})},40561:function(e,t,n){"use strict";var a=n(82109),i=n(17854),r=n(51400),s=n(19303),l=n(26244),o=n(47908),c=n(65417),u=n(86135),d=n(81194),m=d("splice"),p=i.TypeError,f=Math.max,h=Math.min,g=9007199254740991,b="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!m},{splice:function(e,t){var n,a,i,d,m,y,v=o(this),k=l(v),x=r(e,k),w=arguments.length;if(0===w?n=a=0:1===w?(n=0,a=k-x):(n=w-2,a=h(f(s(t),0),k-x)),k+n-a>g)throw p(b);for(i=c(v,a),d=0;d<a;d++)m=x+d,m in v&&u(i,d,v[m]);if(i.length=a,n<a){for(d=x;d<k-a;d++)m=d+a,y=d+n,m in v?v[y]=v[m]:delete v[y];for(d=k;d>k-a+n;d--)delete v[d-1]}else if(n>a)for(d=k-a;d>x;d--)m=d+a-1,y=d+n-1,m in v?v[y]=v[m]:delete v[y];for(d=0;d<n;d++)v[d+x]=arguments[d+2];return v.length=k-a+n,i}})},47941:function(e,t,n){var a=n(82109),i=n(47908),r=n(81956),s=n(47293),l=s((function(){r(1)}));a({target:"Object",stat:!0,forced:l},{keys:function(e){return r(i(e))}})},61808:function(e,t){"use strict";t["Z"]='<template>\n  <div class="MonHocToan">\n    <raw-loader :mytxt="require(\'!raw-loader!./CrudWithImage.vue\').default"></raw-loader>\n\n    <b-container fluid>\n      \x3c!-- User Interface controls --\x3e\n      \x3c!-- Main table element --\x3e\n      <form @submit.stop.prevent="onSave">\n        <b-table thead-class="myTable" ref="mytable" :items="myProvider" :fields="fields" :current-page="currentPage"\n          :per-page="perPage" :filter="filter" :filter-included-fields="filterOn" :sort-by.sync="sortBy"\n          :sort-desc.sync="sortDesc" :sort-direction="sortDirection" stacked="sm" show-empty small fixed outlined\n          bordered @filtered="onFiltered">\n          <template v-slot:cell()="{ value, item, field: { key } }">\n            <template v-if="sel[pri] != item[pri]">\n              <template v-if="item[pri] != 0">\n                <template v-if="key == pri">\n                  {{ value }}\n                </template>\n                <template v-if="key == \'HinhAnh\'">\n                  <img :src="`/api/FileUpload/GetImage/${item[key]}`" width="50" height="30" />\n                </template>\n                <template v-if="key == \'Ten\'">\n                  {{ value }}\n                </template>\n                <template v-if="key == \'NgayMua\'">\n                  {{ value }}\n                </template>\n                <template v-if="key == \'GiaTien\'">\n                  {{ value }}\n                </template>\n              </template>\n            </template>\n            <template v-if="(sel[pri] == item[pri] || item[pri] == 0)">\n              <template v-if="key == \'Id\'">\n                <span>{{ value }}</span>\n              </template>\n              <template v-if="key == \'HinhAnh\'">\n                <com-upload-2 ref="HinhAnh" :src="`/api/FileUpload/GetImage/${item[key]}`"></com-upload-2>\n              </template>\n              <template v-if="key == \'Ten\'">\n                <b-form-input v-model="item[key]" :name="key" v-validate="\'required\'" placeholder=""\n                  :class="{ \'ko-hop-le\': errors.has(key) }">\n                </b-form-input>\n              </template>\n              <template v-if="key == \'NgayMua\'">\n                <b-form-datepicker v-model="item[key]"\n                  :date-format-options="{ year: \'numeric\', month: \'numeric\', day: \'numeric\' }" locale="vi" class="mb-2">\n                </b-form-datepicker>\n              </template>\n              <template v-if="key == \'GiaTien\'">\n                <b-form-input v-model="item[key]" :name="key" v-validate="\'required\'" placeholder=""\n                  :class="{ \'text-right\':true, \'ko-hop-le\': errors.has(key) }">\n                </b-form-input>\n              </template>\n            </template>\n          </template>\n          <template #cell(cmd)="row">\n            <template v-if="row.item[pri] == 0">\n              <b-button class="mr-1" size="sm" @click="onSave(row.item)">\n                <b-icon-hand-thumbs-up></b-icon-hand-thumbs-up>\n              </b-button>\n              <b-button class="mr-1" size="sm" @click="OnCancel(row.item)">\n                <b-icon-file-x></b-icon-file-x>\n              </b-button>\n            </template>\n            <template v-else>\n              <b-button variant="outline" class="mr-1" v-if="sel[pri] != row.item[pri]" size="sm"\n                @click="OnEdit(row.item)">\n                <b-icon-pencil-square></b-icon-pencil-square>\n              </b-button>\n              <b-button variant="outline" class="mr-1" v-if="sel[pri] != row.item[pri]" size="sm"\n                @click="OnDel(row.item)">\n                <b-icon-trash></b-icon-trash>\n              </b-button>\n              <b-button variant="outline" class="mr-1" v-if="sel[pri] == row.item[pri]" size="sm"\n                @click="onSave(row.item)">\n                <b-icon-hand-thumbs-up></b-icon-hand-thumbs-up>\n              </b-button>\n              <b-button variant="outline" class="mr-1" v-if="sel[pri] == row.item[pri]" size="sm"\n                @click="OnCancel(row.item)">\n                <b-icon-file-x></b-icon-file-x>\n              </b-button>\n            </template>\n          </template>\n\n          <template #bottom-row="data">\n            <td :colspan="data.columns">\n              <b-row>\n                <b-col sm="6" class="my-1">\n                  <b-form-group label="Tìm kiếm" label-for="filter-input" label-cols-sm="3" label-align-sm="right"\n                    label-size="sm" class="mb-0">\n                    <b-input-group size="sm">\n                      <b-form-input id="filter-input" v-model="filter" type="search" placeholder="Type to Search">\n                      </b-form-input>\n\n                      <b-input-group-append>\n                        <b-button :disabled="!filter" @click="filter = \'\'">Clear</b-button>\n                      </b-input-group-append>\n                    </b-input-group>\n                  </b-form-group>\n                </b-col>\n                <b-col sm="6" class="my-1">\n                  <b-form-group label="Số dòng" label-for="per-page-select" label-cols-sm="6" label-cols-md="4"\n                    label-cols-lg="3" label-align-sm="right" label-size="sm" class="mb-0">\n                    <b-form-select id="per-page-select" v-model="perPage" :options="pageOptions" size="sm">\n                    </b-form-select>\n                  </b-form-group>\n                </b-col>\n\n                <b-col sm="6" class="my-1 text-right">\n                  <span>page : {{ currentPage }} / {{ last_page }} of {{ totalRows }} </span>\n                  <b-button :disabled="adding == true || isEditing() == true" class="mr-1 mb-1" size="sm"\n                    @click="OnAdd">\n                    <b>Add</b></b-button>\n                </b-col>\n                <b-col sm="6" class="my-1">\n                  <b-pagination ref="mypage" v-model="currentPage" :total-rows="totalRows" :per-page="perPage" size="sm"\n                    align="fill" @change="onChangePage" @input="onPagingInput" first-text="First" prev-text="Prev"\n                    next-text="Next" last-text="Last">\n                  </b-pagination>\n                </b-col>\n              </b-row>\n            </td>\n          </template>\n          <template #row-details="row">\n            <b-card>\n              <ul>\n                <li v-for="(value, key) in row.item" :key="key">{{ key }}: {{ value }}</li>\n              </ul>\n            </b-card>\n          </template>\n        </b-table>\n\n      </form>\n      \x3c!-- Info modal --\x3e\n      <b-modal :id="infoModal.id" :title="infoModal.title" ok-only @hide="resetInfoModal">\n        <pre>{{ infoModal.content }}</pre>\n      </b-modal>\n    </b-container>\n  </div>\n</template>\n<script>\n\nimport VeeValidate from "vee-validate";\nimport Vue from "vue";\nVue.use(VeeValidate, {\n  classes: true,\n  fieldsBagName: \'veeFields\'\n});\n\nimport axios from \'axios\'\nimport ComUpload2 from "./ComUpload2.vue"\nimport moment from "moment";\nimport $ from "jquery"\n\nexport default {\n  components: {\n    ComUpload2\n  },\n\n  data() {\n    return {\n      items: [\n      ],\n      fields: [\n        {\n          key: \'Id\',\n          formatter: (value, key, item) => {\n            return value;\n          },\n          sortable: true,\n          thClass: \'text-center\',\n          tdClass: \'text-center align-middle\',\n          thStyle: { width: "10%" },\n        },\n        {\n          key: \'HinhAnh\',\n          label:\'Hình\',\n          sortable: true,\n          thClass: \'text-center\',\n          tdClass: \'align-middle text-center\',\n          thStyle: { width: "20%" },\n        },\n        {\n          key: \'Ten\',\n          label:\'Tên thiết bị\',\n          sortable: true,\n          thClass: \'text-center\',\n          tdClass: \'align-middle\',\n          thStyle: { width: "35%" },\n        },\n        {\n          key: \'NgayMua\',\n          label:\'Ngày mua\',\n          formatter: (value, key, item) => {\n            return moment(value).format("DD/MM/YYYY");\n          },\n          sortable: true,\n          thClass: \'text-center\',\n          tdClass: \'align-middle text-center\',\n          thStyle: { width: "15%" },\n        },\n        {\n          key: \'GiaTien\',\n          label:\'Giá tiền\',\n          formatter: (value, key, item) => {\n            return parseInt(value).toLocaleString();\n          },\n          sortable: true,\n          thClass: \'text-center\',\n          tdClass: \'align-middle text-right\',\n          thStyle: { width: "10%" },\n        },\n        {\n          key: \'cmd\',\n          class: \'text-center\',\n          thClass: \'text-center\',\n          tdClass: \'align-middle\',\n          thStyle: { width: "10%" }\n        }\n\n      ],\n      totalRows: 1,\n      currentPage: 1,\n      perPage: 5,\n      pageOptions: [5, 10, 15, { value: 100, text: "Show a lot" }],\n      sortBy: \'\',\n      sortDesc: false,\n      sortDirection: \'asc\',\n      filter: null,\n      filterOn: [],\n      infoModal: {\n        id: \'info-modal\',\n        title: \'\',\n        content: \'\'\n      },\n\n      sel: {},\n      pri: "Id",\n      last_page: 0,\n      adding: false\n\n    }\n  },\n\n  watch: {\n    last_page: function (newValue, oldValue) {\n    },\n    currentPage: function (val) {\n    },\n    totalRows: function (newValue, oldValue) {\n    }\n  },\n  computed: {\n  },\n  mounted() {\n  },\n  methods: {\n    onPagingInput() {\n    },\n    myProvider(ctx) {\n      let currentPage = ctx.currentPage;\n      let perPage = ctx.perPage;\n      let sortBy = ctx.sortBy;\n      let sortDesc = ctx.sortDesc;\n      let vm = this;\n      let url = `/api/ThietBi/GetPage2`;\n      url = `${url}?page=${currentPage}&size=${perPage}&sortBy=${sortBy}&sortDesc=${sortDesc}`;\n      if (ctx.filter) {\n        let filter = ctx.filter;\n        url = `${url}&filter=${filter}`;\n      }\n      return axios.get(url)\n        .then(res => {\n          vm.last_page = res.data.last_page;\n          vm.totalRows = res.data.rowCount;\n          if (this.adding == true) {\n            let r = {};\n            r[this.pri] = 0;\n            r["Ten"] = "";\n            r["HinhAnh"] = "no_img.png";\n            r["NgayMua"] = new Date();\n            r["GiaTien"] = 1000;\n            res.data.data.unshift(r);\n          }\n          return vm.mapData(res.data.data); //res.data.data;\n        })\n    },\n    mapData(data) {\n      let kq = [];\n      data.forEach(obj => {\n        let x = {};\n        Object.keys(obj).forEach(key => {\n          let k = key;\n          x[k] = obj[key];\n        });\n        kq.push(x);\n      })\n      return kq;\n    },\n    onChangePage() {\n      this.sel = {};\n      this.adding = false;\n    },\n    OnAdd() {\n      this.adding = true;\n      this.$refs.mytable.refresh();\n    },\n    OnEdit(item) {\n      if (JSON.stringify(this.sel) != "{}" || this.adding == true) {\n        return;\n      }\n      this.sel = JSON.parse(JSON.stringify(item));\n    },\n    onSave(item) {\n      this.$validator.validateAll().then((result) => {\n        if (!result) {\n          this.toast("Không hợp lệ");\n          return;\n        }\n        let r = JSON.parse(JSON.stringify(item));\n        let file = this.$refs.HinhAnh.getFile();\n        var formData = new FormData();\n        formData.append("Id", r.Id);\n        formData.append("Ten", r.Ten);\n        formData.append("HinhAnh", r.HinhAnh);\n        formData.append("NgayMua", r.NgayMua);\n        formData.append("GiaTien", r.GiaTien);\n        formData.append("File", file);\n        let that = this;\n        $.ajax(\n          {\n            url: "/api/ThietBi/Save3",\n            data: formData,\n            processData: false,\n            contentType: false,\n            type: "POST",\n            success: function (res) {\n              alert(JSON.stringify(res));\n              if (item.pri == 0) {\n              } else {\n                that.sel = {};\n              }\n              that.toast(`${res.msg}`);\n              that.adding = false;\n              that.$refs.mytable.refresh();\n            }\n          }\n        );\n      });\n    },\n    OnCancel(item) {\n      if (item[this.pri] != 0) {\n        this.doCancel(item);\n        this.sel = {};\n      } else {\n        this.adding = false;\n        this.$refs.mytable.refresh();\n      }\n    },\n    OnDel(item) {\n      this.Del(item[this.pri]).then(res => {\n        //alert(JSON.stringify(res));\n        //{"data":{"kq":"ok","msg":"Delete thiết bị ok"},"status":200,"statusText":"OK","headers":{"content-length":"42","con\n        if( res.data.kq != \'ok\' ){\n          return;\n        }\n        this.toast(`${res.data.msg}`)        \n        let lastPage = this.getLastPage(this.totalRows - 1);\n        if (lastPage < this.currentPage) this.currentPage = lastPage;\n        this.$refs.mytable.refresh();\n      })\n    },\n    delRow(item) {\n      let id = item.id;\n      let index = this.items.findIndex(x => x.id == id);\n      this.items.splice(index, 1);\n    },\n    isEditing() {\n      return JSON.stringify(this.sel) != "{}"\n    },\n    isAdded() {\n      let kq = false;\n      this.items.forEach(x => {\n        if (x.id == 0) kq = true;\n      })\n      return kq;\n    },\n    doCancel(item) {\n      for (let key in item) {\n        if (item[key] != this.sel[key]) {\n          item[key] = this.sel[key]\n        }\n      }\n    },\n    getLastPage(count) {\n      let pageSize = this.perPage;//this.tabulator.getPageSize();\n      let du = count % pageSize;\n      return du == 0 ? count / pageSize : (count - du) / pageSize + 1;\n    },\n    gotoPage(page) {\n      this.currentPage = page;\n      this.$refs.mytable.refresh();\n    },\n\n    toast(msg, variant = null) {\n      this.$bvToast.toast(msg, {\n        title: `Information`,\n        variant: variant,\n        solid: true,\n      });\n    },\n\n    async Save(r) {\n      return await axios.post(`/api/Ban/Save`, r).catch((err) => {\n        console.log(err);\n      });\n    },\n    async Del(id) {\n      return await axios\n        .get(`/api/ThietBi/Delete?id=${id}`)\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    async getById(id) {\n      return await axios.get(`/api/Ban/GetById?id=${id}`).catch((err) => {\n        console.log(err);\n      });\n    },\n    async GetCombo() {\n      return await axios.get(`/api/Ban/GetCombo`).catch((err) => {\n        console.log(err);\n      });\n    },\n    info(item, index, button) {\n      this.infoModal.title = `Row index: ${index}`\n      this.infoModal.content = JSON.stringify(item, null, 2)\n      this.$root.$emit(\'bv::show::modal\', this.infoModal.id, button)\n    },\n    resetInfoModal() {\n      this.infoModal.title = \'\'\n      this.infoModal.content = \'\'\n    },\n    onFiltered(filteredItems) {\n      // Trigger pagination to update the number of buttons/pages due to filtering\n      this.totalRows = filteredItems.length\n      this.currentPage = 1\n    }\n  }\n\n}\n<\/script>\n<style lang="scss">\n@import "@/assets/scss/myStyle.scss";\n</style>\n\n'}}]);
//# sourceMappingURL=4535-legacy.8bd3177a.js.map