(self["webpackChunkvue_start_1"]=self["webpackChunkvue_start_1"]||[]).push([[1115],{11115:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return v}});var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-container",{attrs:{fluid:""}},[r("raw-loader",{attrs:{mytxt:n(52449).Z}}),r("div",[t._v(t._s(t.Lds()))]),r("button",{attrs:{disabled:1==t.adding||1==t.isEditing()},on:{click:t.onSave1}},[t._v("Save")]),r("form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.onSave.apply(null,arguments)}}},[r("b-table",{ref:"mytable",attrs:{items:t.items,fields:t.fields,"current-page":t.currentPage,"per-page":t.perPage,filter:t.filter,"filter-included-fields":t.filterOn,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"sort-direction":t.sortDirection,stacked:"md",striped:"","show-empty":"",small:"",fixed:"",outlined:"",bordered:""},on:{"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e},filtered:t.onFiltered},scopedSlots:t._u([{key:"cell()",fn:function(e){var n=e.value,i=e.item,s=e.field.key;return[t.sel[t.pri]!=i[t.pri]?[0!=i[t.pri]?[s==t.pri?[t._v(" "+t._s(n)+" ")]:t._e(),"Name"==s?[t._v(" "+t._s(n)+" ")]:t._e()]:t._e()]:t._e(),t.sel[t.pri]==i[t.pri]||0==i[t.pri]?[s==t.pri?[r("span",[t._v(t._s(n))])]:t._e(),"Name"==s?[r("b-form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"ko-hop-le":t.errors.has(s),"text-right":!1},attrs:{autocomplete:"off",name:s,placeholder:""},model:{value:i[s],callback:function(e){t.$set(i,s,e)},expression:"item[key]"}})]:t._e()]:t._e()]}},{key:"cell(cmd)",fn:function(e){return[0==e.item[t.pri]?[r("b-button",{staticClass:"mr-1",attrs:{variant:"outline",size:"sm"},on:{click:function(n){return t.onSave(e.item)}}},[r("b-icon-hand-thumbs-up")],1),r("b-button",{staticClass:"mr-1",attrs:{variant:"outline",size:"sm"},on:{click:function(n){return t.OnCancel(e.item)}}},[r("b-icon-file-x")],1)]:[t.sel[t.pri]!=e.item[t.pri]?r("b-button",{staticClass:"mr-1",attrs:{variant:"outline",disabled:1==t.isAdded(),size:"sm"},on:{click:function(n){return t.OnEdit(e.item)}}},[r("b-icon-pencil-square")],1):t._e(),t.sel[t.pri]!=e.item[t.pri]?r("b-button",{staticClass:"mr-1",attrs:{variant:"outline",disabled:1==t.isAdded(),size:"sm"},on:{click:function(n){return t.OnDel(e.item)}}},[r("b-icon-trash")],1):t._e(),t.sel[t.pri]==e.item[t.pri]?r("b-button",{staticClass:"mr-1",attrs:{variant:"outline",size:"sm"},on:{click:function(n){return t.onSave(e.item)}}},[r("b-icon-hand-thumbs-up")],1):t._e(),t.sel[t.pri]==e.item[t.pri]?r("b-button",{staticClass:"mr-1",attrs:{variant:"outline",size:"sm"},on:{click:function(n){return t.OnCancel(e.item)}}},[r("b-icon-file-x")],1):t._e()]]}},{key:"bottom-row",fn:function(e){return[r("td",{attrs:{colspan:e.columns}},[r("b-row",[r("b-col",{staticClass:"my-1",attrs:{sm:"6"}},[r("b-form-group",{staticClass:"mb-0",attrs:{label:"Filter","label-for":"filter-input","label-cols-sm":"3","label-align-sm":"right","label-size":"sm"}},[r("b-input-group",{attrs:{size:"sm"}},[r("b-form-input",{attrs:{id:"filter-input",type:"search",placeholder:"Type to Search"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),r("b-input-group-append",[r("b-button",{attrs:{disabled:!t.filter},on:{click:function(e){t.filter=""}}},[t._v("Clear")])],1)],1)],1)],1),r("b-col",{staticClass:"my-1",attrs:{sm:"6"}},[r("b-form-group",{staticClass:"mb-0",attrs:{label:"Per page","label-for":"per-page-select","label-cols-sm":"6","label-cols-md":"4","label-cols-lg":"3","label-align-sm":"right","label-size":"sm"}},[r("b-form-select",{attrs:{id:"per-page-select",options:t.pageOptions,size:"sm"},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),r("b-col",{staticClass:"my-1 text-right",attrs:{sm:"6"}},[t._v(" page :"+t._s(t.currentPage)+" / "+t._s(t.getLastPage(t.totalRows))+" of "+t._s(t.totalRows)+" "),r("b-button",{attrs:{disabled:1==t.adding||1==t.isEditing(),size:"sm"},on:{click:t.OnAdd}},[r("b",[t._v("Add")])])],1),r("b-col",{staticClass:"my-1",attrs:{sm:"6"}},[r("b-pagination",{staticClass:"my-0",attrs:{disabled:1==t.adding||1==t.isEditing(),"total-rows":t.totalRows,"per-page":t.perPage,align:"fill",size:"sm"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1)]}}])})],1),r("b-modal",{attrs:{id:t.infoModal.id,title:t.infoModal.title,"ok-only":""},on:{hide:t.resetInfoModal}},[r("pre",[t._v(t._s(t.infoModal.content))])])],1)},i=[],s=n(77673),a=n(16198),o=(n(41539),n(39714),n(21249),n(57327),n(34553),n(38862),n(40561),n(54747),n(12954)),l=n(20144),d=(n(30381),n(19938)),c=n.n(d),u=n(11678),m=n(70790),f=n(53009);l["default"].use(o.ZP,{classes:!0,fieldsBagName:"veeFields"}),l["default"].component("v-select",c());var p={props:["LopHocId"],mixins:[u.Z],data:function(){return{items:[],fields:[{key:"Id",formatter:function(t,e,n){var r=t.toString();return r.length<4?r:r.substring(0,4)+"..."},sortable:!0,thClass:"text-center",tdClass:"text-center align-middle",thStyle:{width:"10%"}},{key:"Name",sortable:!0,thClass:"text-center",tdClass:"align-middle",thStyle:{width:"80%"}},{key:"cmd",class:"text-center",thClass:"text-center",tdClass:"align-middle",thStyle:{width:"10%"}}],totalRows:1,currentPage:1,perPage:3,pageOptions:[3,5,10,15,{value:100,text:"Show a lot"}],sortBy:"",sortDesc:!1,sortDirection:"asc",filter:null,filterOn:[],infoModal:{id:"info-modal",title:"",content:""},sel:{},pri:"Id",adding:!1,lastPage:0,ds:[],Mons:[]}},computed:{sortOptions:function(){return this.fields.filter((function(t){return t.sortable})).map((function(t){return{text:t.label,value:t.key}}))}},mounted:function(){this.GetAll()},methods:{UpdateRow:function(t,e,n,r){t.SoLg=0,t.Tien=0},onSoLgChange:function(t){var e=t.SoLg*t.DonGia;t.Tien=e},onMonChange:function(t){var e=t.MonId,n=this.Mons.findIndex((function(t){return t.id==e}));if(n>=0){var r=this.Mons[n].price,i=t.SoLg,s=i*r;t.DonGia=r,t.Tien=s}},onSave1:function(){var t=this.Lds();this.UpdateList(t)},onSave:function(t){var e=this;this.$validator.validateAll().then((function(n){if(n){var r=JSON.parse(JSON.stringify(t));if(0==r[e.pri]){var i=e.items.findIndex((function(t){return t[e.pri]==r[e.pri]}));r[e.pri]=e.createId(),e.Add(r),e.$set(e.items,i,r),e.adding=!1,e.$refs.mytable.refresh()}else{e.Update(r);var s=e.items.findIndex((function(t){return t[e.pri]==r[e.pri]}));e.$set(e.items,s,r),e.sel={}}}else e.toast("Không hợp lệ")}))},OnDel:function(t){this.delRow(t),this.Del(t)},delRow:function(t){var e=this,n=t[this.pri],r=this.items.findIndex((function(t){return t[e.pri]==n}));this.items.splice(r,1),this.totalRows=this.items.length,this.lastPage=this.getLastPage(this.totalRows)},doCancel:function(t){for(var e in t)t[e]!=this.sel[e]&&(t[e]=this.sel[e])},isAdded:function(){var t=this,e=!1;return this.items.forEach((function(n){0==n[t.pri]&&(e=!0)})),e},OnEdit:function(t){"{}"==JSON.stringify(this.sel)&&(this.sel=JSON.parse(JSON.stringify(t)))},OnCancel:function(t){var e=this;if(0==t[this.pri]){var n=this.items.findIndex((function(n){return n[e.pri]==t[e.pri]}));this.items.splice(n,1),this.adding=!1,this.$refs.mytable.refresh()}else this.doCancel(t),this.sel={}},OnAdd:function(){var t={Id:0,Name:"Ban so"};this.items.unshift(t),this.adding=!0,this.currentPage=1,this.totalRows=this.items.length,this.$refs.mytable.refresh()},isEditing:function(){return"{}"!=JSON.stringify(this.sel)},getLastPage:function(t){var e=this.perPage,n=t%e;return 0==n?t/e:(t-n)/e+1},info:function(t,e,n){this.infoModal.title="Row index: ".concat(e),this.infoModal.content=JSON.stringify(t,null,2),this.$root.$emit("bv::show::modal",this.infoModal.id,n)},resetInfoModal:function(){this.infoModal.title="",this.infoModal.content=""},onFiltered:function(t){this.totalRows=t.length,this.currentPage=1},toast:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.$bvToast.toast(t,{title:"Information",variant:e,solid:!0})},GetAll:function(){var t=this;return(0,a.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m.Z.get("/api/Ban4/GetAll").then((function(e){var n=e.data.list;t.SetPri(t.pri),t.SetDs(n),t.items=n,t.totalRows=t.items.length,t.lastPage=t.getLastPage(t.totalRows),t.LdsMon()})).catch((function(t){f.Z.XuLyErr(t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},LdsMon:function(){var t=this;return(0,a.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,m.Z)("/api/Mon2/ListMonComboPrice").then((function(e){t.Mons=e.data.list})).catch((function(t){f.Z.XuLyErr(t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},UpdateList:function(t){var e=this;return(0,a.Z)((0,s.Z)().mark((function n(){return(0,s.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,m.Z.post("/api/BanChiTiet2/UpdateBanChiTietNote",t).then((function(t){e.GetAll()})).catch((function(t){f.Z.XuLyErr(t)}));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()}}},h=p,b=n(1001),g=(0,b.Z)(h,r,i,!1,null,null,null),v=g.exports},67066:function(t,e,n){"use strict";var r=n(19670);t.exports=function(){var t=r(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},34706:function(t,e,n){var r=n(46916),i=n(92597),s=n(47976),a=n(67066),o=RegExp.prototype;t.exports=function(t){var e=t.flags;return void 0!==e||"flags"in o||i(t,"flags")||!s(o,t)?e:r(a,t)}},21249:function(t,e,n){"use strict";var r=n(82109),i=n(42092).map,s=n(81194),a=s("map");r({target:"Array",proto:!0,forced:!a},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},40561:function(t,e,n){"use strict";var r=n(82109),i=n(17854),s=n(51400),a=n(19303),o=n(26244),l=n(47908),d=n(65417),c=n(86135),u=n(81194),m=u("splice"),f=i.TypeError,p=Math.max,h=Math.min,b=9007199254740991,g="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!m},{splice:function(t,e){var n,r,i,u,m,v,y=l(this),x=o(y),w=s(t,x),S=arguments.length;if(0===S?n=r=0:1===S?(n=0,r=x-w):(n=S-2,r=h(p(a(e),0),x-w)),x+n-r>b)throw f(g);for(i=d(y,r),u=0;u<r;u++)m=w+u,m in y&&c(i,u,y[m]);if(i.length=r,n<r){for(u=w;u<x-r;u++)m=u+r,v=u+n,m in y?y[v]=y[m]:delete y[v];for(u=x;u>x-r+n;u--)delete y[u-1]}else if(n>r)for(u=x-r;u>w;u--)m=u+r-1,v=u+n-1,m in y?y[v]=y[m]:delete y[v];for(u=0;u<n;u++)y[u+w]=arguments[u+2];return y.length=x-r+n,i}})},47941:function(t,e,n){var r=n(82109),i=n(47908),s=n(81956),a=n(47293),o=a((function(){s(1)}));r({target:"Object",stat:!0,forced:o},{keys:function(t){return s(i(t))}})},39714:function(t,e,n){"use strict";var r=n(76530).PROPER,i=n(98052),s=n(19670),a=n(41340),o=n(47293),l=n(34706),d="toString",c=RegExp.prototype,u=c[d],m=o((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),f=r&&u.name!=d;(m||f)&&i(RegExp.prototype,d,(function(){var t=s(this),e=a(t.source),n=a(l(t));return"/"+e+"/"+n}),{unsafe:!0})},52449:function(t,e){"use strict";e["Z"]='<template>\r\n    <b-container fluid>\r\n        <raw-loader :mytxt="require(\'!raw-loader!./BanTblSub.vue\').default"></raw-loader>\r\n        <div>{{ Lds() }}</div>\r\n        \x3c!-- <div>{{ Mons }}</div> --\x3e\r\n        <button :disabled="adding == true || isEditing() == true" @click="onSave1">Save</button>\r\n        <form @submit.stop.prevent="onSave">\r\n            <b-table ref="mytable" :items="items" :fields="fields" :current-page="currentPage" :per-page="perPage"\r\n                :filter="filter" :filter-included-fields="filterOn" :sort-by.sync="sortBy" :sort-desc.sync="sortDesc"\r\n                :sort-direction="sortDirection" stacked="md" striped show-empty small fixed outlined bordered\r\n                @filtered="onFiltered">\r\n                <template v-slot:cell()="{ value, item, field: { key } }">\r\n                    <template v-if="sel[pri] != item[pri]">\r\n                        <template v-if="item[pri] != 0">\r\n                            <template v-if="key == pri">\r\n                                {{ value }}\r\n                            </template>\r\n                            <template v-if="key == \'Name\'">\r\n                                {{ value }}\r\n                            </template>\r\n                        </template>\r\n                    </template>\r\n                    <template v-if="(sel[pri] == item[pri] || item[pri] == 0)">\r\n                        <template v-if="key == pri">\r\n                            <span>{{ value }}</span>\r\n                        </template>\r\n                        <template v-if="key == \'Name\'">\r\n                            <b-form-input autocomplete="off" v-model="item[key]" :name="key" v-validate="\'required\'"\r\n                                placeholder="" :class="{ \'ko-hop-le\': errors.has(key), \'text-right\': false }">\r\n                            </b-form-input>\r\n                        </template>\r\n\r\n                    </template>\r\n                </template>\r\n\r\n                <template #cell(cmd)="row">\r\n                    <template v-if="row.item[pri] == 0">\r\n                        <b-button variant="outline" class="mr-1" size="sm" @click="onSave(row.item)">\r\n                            <b-icon-hand-thumbs-up></b-icon-hand-thumbs-up>\r\n                        </b-button>\r\n                        <b-button variant="outline" class="mr-1" size="sm" @click="OnCancel(row.item)">\r\n                            <b-icon-file-x></b-icon-file-x>\r\n                        </b-button>\r\n                    </template>\r\n                    <template v-else>\r\n                        <b-button variant="outline" :disabled="isAdded() == true" class="mr-1"\r\n                            v-if="sel[pri] != row.item[pri]" size="sm" @click="OnEdit(row.item)">\r\n                            <b-icon-pencil-square></b-icon-pencil-square>\r\n                        </b-button>\r\n                        <b-button variant="outline" :disabled="isAdded() == true" class="mr-1"\r\n                            v-if="sel[pri] != row.item[pri]" size="sm" @click="OnDel(row.item)">\r\n                            <b-icon-trash></b-icon-trash>\r\n                        </b-button>\r\n                        <b-button variant="outline" class="mr-1" v-if="sel[pri] == row.item[pri]" size="sm"\r\n                            @click="onSave(row.item)">\r\n                            <b-icon-hand-thumbs-up></b-icon-hand-thumbs-up>\r\n                        </b-button>\r\n                        <b-button variant="outline" class="mr-1" v-if="sel[pri] == row.item[pri]" size="sm"\r\n                            @click="OnCancel(row.item)">\r\n                            <b-icon-file-x></b-icon-file-x>\r\n                        </b-button>\r\n                    </template>\r\n                </template>\r\n                <template #bottom-row="data">\r\n                    <td :colspan="data.columns">\r\n                        <b-row>\r\n                            <b-col sm="6" class="my-1">\r\n                                <b-form-group label="Filter" label-for="filter-input" label-cols-sm="3"\r\n                                    label-align-sm="right" label-size="sm" class="mb-0">\r\n                                    <b-input-group size="sm">\r\n                                        <b-form-input id="filter-input" v-model="filter" type="search"\r\n                                            placeholder="Type to Search"></b-form-input>\r\n                                        <b-input-group-append>\r\n                                            <b-button :disabled="!filter" @click="filter = \'\'">Clear</b-button>\r\n                                        </b-input-group-append>\r\n                                    </b-input-group>\r\n                                </b-form-group>\r\n                            </b-col>\r\n                            <b-col sm="6" class="my-1">\r\n                                <b-form-group label="Per page" label-for="per-page-select" label-cols-sm="6"\r\n                                    label-cols-md="4" label-cols-lg="3" label-align-sm="right" label-size="sm" class="mb-0">\r\n                                    <b-form-select id="per-page-select" v-model="perPage" :options="pageOptions"\r\n                                        size="sm"></b-form-select>\r\n                                </b-form-group>\r\n                            </b-col>\r\n                            <b-col sm="6" class="my-1 text-right">\r\n                                page :{{ currentPage }} / {{ getLastPage(totalRows) }} of {{ totalRows }}\r\n                                <b-button :disabled="adding == true || isEditing() == true" @click="OnAdd"\r\n                                    size="sm"><b>Add</b></b-button>\r\n                            </b-col>\r\n                            <b-col sm="6" class="my-1">\r\n                                <b-pagination :disabled="adding == true || isEditing() == true" v-model="currentPage"\r\n                                    :total-rows="totalRows" :per-page="perPage" align="fill" size="sm"\r\n                                    class="my-0"></b-pagination>\r\n                            </b-col>\r\n                        </b-row>\r\n                    </td>\r\n                </template>\r\n            </b-table>\r\n        </form>\r\n        \x3c!-- Info modal --\x3e\r\n        <b-modal :id="infoModal.id" :title="infoModal.title" ok-only @hide="resetInfoModal">\r\n            <pre>{{ infoModal.content }}</pre>\r\n        </b-modal>\r\n    </b-container>\r\n</template>\r\n<script>\r\nimport VeeValidate from "vee-validate";\r\nimport Vue from "vue";\r\nVue.use(VeeValidate, {\r\n    classes: true,\r\n    fieldsBagName: \'veeFields\'\r\n});\r\n\r\nimport moment from "moment";\r\nimport vSelect from "vue-select";\r\nVue.component("v-select", vSelect);\r\nimport ListMixin from "@/ListMixin"\r\n\r\nimport fetchClient from \'@/fetchClient\';\r\nimport TumLum from \'@/TumLum\';\r\n\r\nexport default {\r\n    props: ["LopHocId"],\r\n    mixins: [ListMixin],\r\n    data() {\r\n        return {\r\n            items: [\r\n            ],\r\n            fields: [\r\n                {\r\n                    key: \'Id\',\r\n                    formatter: (value, key, item) => {\r\n                        let text = value.toString();\r\n                        return (text.length < 4) ? text : text.substring(0, 4) + "...";\r\n                    },\r\n                    sortable: true,\r\n                    thClass: \'text-center\',\r\n                    tdClass: \'text-center align-middle\',\r\n                    //tdClass: \'align-middle\'\r\n                    thStyle: { width: "10%" },\r\n                },\r\n                //{ key: \'TenHocSinh\', sortable: true, thClass: \'text-center\', tdClass: \'align-middle\', thStyle: { width: "80%" }, },\r\n                { key: \'Name\', sortable: true, thClass: \'text-center\', tdClass: \'align-middle\', thStyle: { width: "80%" }, },\r\n                {\r\n                    key: \'cmd\',\r\n                    class: \'text-center\',\r\n                    thClass: \'text-center\',\r\n                    tdClass: \'align-middle\',\r\n                    thStyle: { width: "10%" }\r\n                }\r\n            ],\r\n            totalRows: 1,\r\n            currentPage: 1,\r\n            perPage: 3,\r\n            pageOptions: [3, 5, 10, 15, { value: 100, text: "Show a lot" }],\r\n            sortBy: \'\',\r\n            sortDesc: false,\r\n            sortDirection: \'asc\',\r\n            filter: null,\r\n            filterOn: [],\r\n            infoModal: {\r\n                id: \'info-modal\',\r\n                title: \'\',\r\n                content: \'\'\r\n            },\r\n\r\n            sel: {},\r\n            pri: \'Id\',\r\n            adding: false,\r\n            lastPage: 0,\r\n\r\n            ds: [],\r\n            Mons: [],\r\n\r\n        }\r\n    },\r\n    computed: {\r\n        sortOptions() {\r\n            return this.fields\r\n                .filter(f => f.sortable)\r\n                .map(f => {\r\n                    return { text: f.label, value: f.key }\r\n                })\r\n        }\r\n    },\r\n    mounted() {\r\n        this.GetAll();\r\n    },\r\n    methods: {\r\n        UpdateRow(item, DonGia, SoLg, Tien) {\r\n            item.SoLg = 0;\r\n            item.Tien = 0;\r\n        },\r\n        onSoLgChange(item) {\r\n            let Tien = item.SoLg * item.DonGia;\r\n            item.Tien = Tien;\r\n        },\r\n        onMonChange(item) {\r\n            let MonId = item.MonId;\r\n            let index = this.Mons.findIndex(x => x.id == MonId);\r\n            if (index >= 0) {\r\n                let price = this.Mons[index].price;\r\n                let SoLg = item.SoLg;\r\n                let Tien = SoLg * price;\r\n                item.DonGia = price;\r\n                item.Tien = Tien;\r\n            }\r\n        },\r\n        onSave1() {\r\n            let list = this.Lds();\r\n            this.UpdateList(list);\r\n        },\r\n        onSave(item) {\r\n            this.$validator.validateAll().then((result) => {\r\n                if (!result) {\r\n                    this.toast("Không hợp lệ");\r\n                    return;\r\n                }\r\n                let r = JSON.parse(JSON.stringify(item));\r\n                if (r[this.pri] == 0) {\r\n                    let index = this.items.findIndex(x => x[this.pri] == r[this.pri]);\r\n\r\n                    r[this.pri] = this.createId();\r\n                    this.Add(r);\r\n\r\n                    this.$set(this.items, index, r);\r\n                    this.adding = false;\r\n                    this.$refs.mytable.refresh();\r\n                } else {\r\n\r\n                    this.Update(r);\r\n\r\n                    let index = this.items.findIndex(x => x[this.pri] == r[this.pri]);\r\n                    this.$set(this.items, index, r);\r\n                    this.sel = {};\r\n                }\r\n            });\r\n        },\r\n        OnDel(item) {\r\n            this.delRow(item);\r\n\r\n            this.Del(item);\r\n\r\n        },\r\n        delRow(item) {\r\n            let id = item[this.pri];\r\n            let index = this.items.findIndex(x => x[this.pri] == id);\r\n            this.items.splice(index, 1);\r\n            this.totalRows = this.items.length;\r\n            this.lastPage = this.getLastPage(this.totalRows);\r\n        },\r\n        doCancel(item) {\r\n            for (let key in item) {\r\n                if (item[key] != this.sel[key]) {\r\n                    item[key] = this.sel[key]\r\n                }\r\n            }\r\n        },\r\n        isAdded() {\r\n            let kq = false;\r\n            this.items.forEach(x => {\r\n                if (x[this.pri] == 0) kq = true;\r\n            })\r\n            return kq;\r\n        },\r\n        OnEdit(item) {\r\n            if (JSON.stringify(this.sel) != "{}") return;\r\n            this.sel = JSON.parse(JSON.stringify(item));\r\n        },\r\n        OnCancel(item) {\r\n            if (item[this.pri] == 0) {\r\n                let index = this.items.findIndex(x => x[this.pri] == item[this.pri]);\r\n                this.items.splice(index, 1);\r\n                this.adding = false;\r\n                this.$refs.mytable.refresh();\r\n            } else {\r\n                this.doCancel(item);\r\n                this.sel = {};\r\n            }\r\n        },\r\n        OnAdd() {\r\n            let r = {\r\n                Id: 0,\r\n                Name: \'Ban so\',\r\n            }\r\n            this.items.unshift(r);\r\n            this.adding = true;\r\n            this.currentPage = 1;\r\n            this.totalRows = this.items.length;\r\n            this.$refs.mytable.refresh();\r\n        },\r\n        isEditing() {\r\n            return JSON.stringify(this.sel) != "{}"\r\n        },\r\n        getLastPage(count) {\r\n            let pageSize = this.perPage;//this.tabulator.getPageSize();\r\n            let du = count % pageSize;\r\n            return du == 0 ? count / pageSize : (count - du) / pageSize + 1;\r\n        },\r\n        info(item, index, button) {\r\n            this.infoModal.title = `Row index: ${index}`\r\n            this.infoModal.content = JSON.stringify(item, null, 2)\r\n            this.$root.$emit(\'bv::show::modal\', this.infoModal.id, button)\r\n        },\r\n        resetInfoModal() {\r\n            this.infoModal.title = \'\'\r\n            this.infoModal.content = \'\'\r\n        },\r\n        onFiltered(filteredItems) {\r\n            this.totalRows = filteredItems.length\r\n            this.currentPage = 1\r\n        },\r\n        toast(msg, variant = null) {\r\n            this.$bvToast.toast(msg, {\r\n                title: `Information`,\r\n                variant: variant,\r\n                solid: true,\r\n            });\r\n        },\r\n        async GetAll() {\r\n            return await fetchClient.get(`/api/Ban4/GetAll`)\r\n                .then(res => {\r\n                    let items = res.data.list;\r\n\r\n                    this.SetPri(this.pri);\r\n                    this.SetDs(items);\r\n\r\n                    this.items = items;\r\n                    this.totalRows = this.items.length;\r\n                    this.lastPage = this.getLastPage(this.totalRows);\r\n\r\n                    this.LdsMon();\r\n                })\r\n                .catch((err) => {\r\n                    TumLum.XuLyErr(err);\r\n                });\r\n        },\r\n        async LdsMon() {\r\n            return await fetchClient(`/api/Mon2/ListMonComboPrice`).then(res => {\r\n                this.Mons = res.data.list;\r\n            }).catch(err => {\r\n                TumLum.XuLyErr(err);\r\n            })\r\n        },\r\n        async UpdateList(list) {\r\n            return await fetchClient.post(`/api/BanChiTiet2/UpdateBanChiTietNote`, list)\r\n                .then(res => {\r\n                    this.GetAll();\r\n                })\r\n                .catch((err) => {\r\n                    TumLum.XuLyErr(err);\r\n                });\r\n        },\r\n    }\r\n}\r\n<\/script>\r\n'},11678:function(t,e,n){"use strict";n(41539),n(54747),n(38862),n(34553),n(47941),n(40561);e["Z"]={data:function(){return{pri:"Id",ds1:[]}},created:function(){},methods:{SetPri:function(t){this.pri=t},SetDs:function(t){var e=this;this.ds1=[],t.forEach((function(t){var n=JSON.parse(JSON.stringify(t));n.Note="",e.ds1.push(n)}))},Lds:function(){return this.ds1},createId:function(){var t=this,e=0;return this.ds1.forEach((function(n){n[t.pri]>e&&(e=n[t.pri])})),e+1},Add:function(t){var e=JSON.parse(JSON.stringify(t));e.Note="new",this.ds1.push(e)},Find:function(t){var e=this,n=this.ds1.findIndex((function(n){return n[e.pri]==t}));return n>=0?this.ds1[n]:null},Update:function(t){var e=this,n=this.Find(t[this.pri]);if(null!=n){var r=JSON.parse(JSON.stringify(n)),i=Object.keys(t);i.forEach((function(e){r[e]=t[e]})),""==r.Note&&(r.Note="edit");var s=this.ds1.findIndex((function(t){return t[e.pri]==r[e.pri]}));this.ds1[s]=r}},Del:function(t){var e=this,n=t[this.pri],r=this.Find(n);if(null!=r){var i=this.ds1.findIndex((function(t){return t[e.pri]==n}));"new"==r.Note?this.ds1.splice(i,1):(r.Note="del",this.ds1[i]=r)}}}}},53009:function(t,e,n){"use strict";n(38862);e["Z"]={XuLyErr:function(t){var e=JSON.parse(JSON.stringify(t)).status;if(400==e){var n=JSON.parse(JSON.stringify(t.response)).data.message;alert(n)}else t.response?401==t.response.status?alert("Chưa đăng nhập hoặc token hết hạn"):403==t.response.status&&alert("Bạn ko có quyền"):t.request?alert(JSON.stringify(t.request)):t.message&&alert(JSON.stringify(t.message))}}},70790:function(t,e,n){"use strict";var r=n(9669),i=n.n(r),s=function(){var t={baseURL:"",method:"get",headers:{"Content-Type":"application/json;charset=utf-8"}},e=i().create(t);return e.interceptors.request.use((function(t){var e=localStorage.getItem("token");return t.headers.Authorization=e?"Bearer ".concat(e):"",t})),e};e["Z"]=s()}}]);
//# sourceMappingURL=1115-legacy.ea3075d4.js.map