"use strict";(self["webpackChunkvue_start_1"]=self["webpackChunkvue_start_1"]||[]).push([[3181],{83181:function(r,n,t){t.r(n),t.d(n,{default:function(){return x}});var e=function(){var r=this,n=r.$createElement,e=r._self._c||n;return e("div",{staticClass:"tpl"},[e("raw-loader",{attrs:{mytxt:t(56055).Z}}),e("h1",[r._v("This is Tabulator2")]),e("div",[e("div",{staticClass:"mb-1"},[e("button",{staticClass:"mr-1",on:{click:r.onAddModal}},[r._v("Add")])]),r._v(" "+r._s(r.msg)+" "),e("div",{ref:"table"}),e("b-modal",{ref:"my-modal",attrs:{size:"sm","no-close-on-backdrop":!0,"hide-footer":"",title:r.title}},[e("div",{staticClass:"d-block"},[e("form",{on:{submit:function(n){return n.stopPropagation(),n.preventDefault(),r.onSaveModal.apply(null,arguments)}}},[e("div",{staticClass:"text-right"},[e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-4 col-form-label"},[r._v("Id")]),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:r.sel.Id,expression:"sel.Id"}],class:{"form-control":!0,"ko-hop-le":r.errors.has("Id")},attrs:{readonly:"",name:"Id",type:"text"},domProps:{value:r.sel.Id},on:{input:function(n){n.target.composing||r.$set(r.sel,"Id",n.target.value)}}})])]),e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-4 col-form-label"},[r._v("Name["+r._s(!r.errors.has("Name"))+"]")]),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:r.sel.Name,expression:"sel.Name"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"form-control":!0,"ko-hop-le":r.errors.has("Name")},attrs:{name:"Name",type:"text"},domProps:{value:r.sel.Name},on:{input:function(n){n.target.composing||r.$set(r.sel,"Name",n.target.value)}}})])]),e("button",{staticClass:"btn mr-1",attrs:{type:"submit"}},[r._v("Save")]),e("button",{staticClass:"btn",attrs:{type:"button"},on:{click:function(n){return r.hideModal()}}},[r._v(" Cancel ")])])])])])],1)],1)},a=[],o=t(77673),i=t(16198),l=t(23796),s=(t(38862),t(69826),t(41539),t(54747),t(60911)),d=t(19755),c=t.n(d),u=t(9669),m=t.n(u),h=t(12954),g=t(20144);g["default"].use(h.ZP,{classes:!0});var p={name:"Ban",components:{},data:function(){var r;return r={msg:"thuc 101",tabulator:null,tableData:[]},(0,l.Z)(r,"msg",""),(0,l.Z)(r,"sel",{}),(0,l.Z)(r,"title",""),r},mounted:function(){var r=this;this.tabulator=new s.Ae(this.$refs.table,{pagination:!0,paginationMode:"remote",ajaxSorting:!0,ajaxURL:"/api/Ban/GetPage",ajaxFiltering:!0,filterMode:"remote",sortMode:"remote",ajaxParams:{token:"ABC123"},paginationSize:2,paginationInitialPage:1,paginationSizeSelector:[5,10,20,30,50],height:c()(window).innerHeight()-400,layout:"fitData",ajaxRequesting:function(n,t){r.msg="".concat(n," - ")+JSON.stringify(t)},index:"Id",columns:[{title:"STT",formatter:"rownum",headerHozAlign:"center",hozAlign:"center"},{title:"Cmd",headerHozAlign:"center",hozAlign:"center",headerSort:!1,width:90,formatter:function(n,t,e){e((function(){c()(n.getElement()).find("#edit").on("click",n.getRow(),r.onEdit),c()(n.getElement()).find("#del").on("click",n.getRow(),r.onDel)}));var a=c()("<div>");return a.append(c()("<button>",{text:"Edit",class:"mr-1"}).attr("id","edit")),a.append(c()("<button>",{text:"Del",class:"mr-1"}).attr("id","del")),a[0]}},{title:"Id",field:"Id",width:80,headerHozAlign:"center",hozAlign:"center",headerFilter:!0},{title:"Name",field:"Name",headerFilter:"input",width:200,headerHozAlign:"center",hozAlign:"left"}]}),this.tabulator.on("dataLoaded",(function(n){var t=c()(r.$refs.table),e=c()("<span id='total' class='mr-1'>").text("[total]");0==t.find(".tabulator-footer-contents").find("span#total").length?t.find(".tabulator-footer-contents span.tabulator-paginator").prepend(e):t.find(".tabulator-footer-contents").find("span#total").text("[".concat((new Date).getTime(),"]"))})),this.tabulator.on("pageLoaded",(function(r){}))},watch:{tableData:{handler:function(r){this.tabulator.replaceData(r)},deep:!0}},created:function(){},methods:{onDataLoaded:function(r){var n=[];r.forEach((function(r,t){n.push({x:r.id})}));var t=this.tabulator.getPage();this.msg={ar:n,curPage:t}},onAddModal:function(){var r={Id:0,Name:"Thuc 101"};this.sel=JSON.parse(JSON.stringify(r)),this.title="Add Bàn",this.showModal()},onSaveModal:function(){var r=this;this.$validator.validateAll().then((function(n){if(n){var t=JSON.parse(JSON.stringify(r.sel));r.Save(t).then((function(n){"ok"==n.data.kq?(r.toast(n.data.msg),r.hideModal(),r.setPage(r.getPage())):r.toast(n.data.msg)}))}else r.toast("Không hợp lệ")}))},Save:function(r){return(0,i.Z)((0,o.Z)().mark((function n(){return(0,o.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,m().post("/api/Ban/Save",r).catch((function(r){console.log(r)}));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},Del:function(r){return(0,i.Z)((0,o.Z)().mark((function n(){return(0,o.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,m().get("/api/Ban/Delete?id=".concat(r)).catch((function(r){console.log(r)}));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},getById:function(r){return(0,i.Z)((0,o.Z)().mark((function n(){return(0,o.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,m().get("/api/Ban/GetById?id=".concat(r)).catch((function(r){console.log(r)}));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},onDel:function(r){var n=this,t=r.data,e=t.getIndex();this.Del(e).then((function(r){"ok"==r.data.kq&&(1!=n.getData().length?n.setPage(n.getPage()):n.setPage(n.getPage()-1)),n.toast(r.data.msg)}))},onEdit:function(r){var n=this,t=r.data,e=t.getIndex();this.getById(e).then((function(r){n.sel=r.data,n.title="Edit Bàn",n.showModal()}))},getData:function(){return this.tabulator.getData()},getPage:function(){return this.tabulator.getPage()},setPage:function(r){this.tabulator.setPage(r)},toast:function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.$bvToast.toast(r,{title:"Information",variant:n,solid:!0})},showModal:function(){this.$refs["my-modal"].show()},hideModal:function(){this.$refs["my-modal"].hide()}}},f=p,v=t(1001),b=(0,v.Z)(f,e,a,!1,null,null,null),x=b.exports},69826:function(r,n,t){var e=t(82109),a=t(42092).find,o=t(51223),i="find",l=!0;i in[]&&Array(1)[i]((function(){l=!1})),e({target:"Array",proto:!0,forced:l},{find:function(r){return a(this,r,arguments.length>1?arguments[1]:void 0)}}),o(i)},56055:function(r,n){n["Z"]='<template>\r\n  <div class="tpl">\r\n    <raw-loader :mytxt=" require(\'!raw-loader!./BanAjax.vue\').default "></raw-loader>\r\n    <h1>This is Tabulator2</h1>\r\n    <div>\r\n      <div class="mb-1">\r\n        <button class="mr-1" @click="onAddModal" >Add</button>\r\n      </div>\r\n      {{msg}}\r\n      <div ref="table"></div>   \r\n      \r\n      <b-modal ref="my-modal" size="sm" :no-close-on-backdrop="true" hide-footer :title=" title ">\r\n      <div class="d-block">\r\n        <form @submit.stop.prevent="onSaveModal">\r\n          <div class="text-right">\r\n            <div class="form-group row">\r\n              <label class="col-sm-4 col-form-label">Id</label>\r\n              <div class="col-sm-8">\r\n                <input\r\n                  readonly\r\n                  name="Id"\r\n                  v-model="sel.Id"\r\n                  :class="{\r\n                    \'form-control\': true,\r\n                    \'ko-hop-le\': errors.has(\'Id\'),\r\n                  }"\r\n                  type="text"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group row">\r\n              <label class="col-sm-4 col-form-label"\r\n                >Name[{{ !errors.has("Name") }}]</label\r\n              >\r\n              <div class="col-sm-8">\r\n                <input\r\n                  name="Name"\r\n                  v-model="sel.Name"\r\n                  :class="{\r\n                    \'form-control\': true,\r\n                    \'ko-hop-le\': errors.has(\'Name\'),\r\n                  }"\r\n                  type="text"\r\n                  v-validate="\'required\'"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n\r\n\r\n\x3c!--\r\n            <div class="form-group row">\r\n              <label class="col-sm-4 col-form-label"\r\n                >Món[{{ !errors.has("monid") }}]</label\r\n              >\r\n              <div class="col-sm-8">\r\n                <v-select\r\n                  :class="{ \'ko-hop-le-select2\': errors.has(\'monid\') }"\r\n                  v-validate="\'required\'"\r\n                  @input="onMonChange()"\r\n                  name="monid"\r\n                  v-model="sel.monid"\r\n                  :reduce="(option) => option.id"\r\n                  :options="\r\n                    mons.map((x) => ({\r\n                      id: x.id,\r\n                      label: `${x.id} - ${x.tenmon}`,\r\n                    }))\r\n                  "\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group row">\r\n              <label class="col-sm-4 col-form-label"\r\n                >Đơn giá[{{ !errors.has("dongia") }}]</label\r\n              >\r\n              <div class="col-sm-8">\r\n                <input\r\n                  name="dongia"\r\n                  readonly\r\n                  v-model="sel.dongia"\r\n                  :class="{\r\n                    \'form-control\': true,\r\n                    \'ko-hop-le\': errors.has(\'dongia\'),\r\n                  }"\r\n                  type="text"\r\n                  v-validate="\'required\'"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group row">\r\n              <label class="col-sm-4 col-form-label"\r\n                >Số lượng[{{ !errors.has("solg") }}]</label\r\n              >\r\n              <div class="col-sm-8">\r\n                <input\r\n                  name="solg"\r\n                  v-model="sel.solg"\r\n                  @change="solgChange()"\r\n                  :class="{\r\n                    \'form-control\': true,\r\n                    \'ko-hop-le\': errors.has(\'solg\'),\r\n                  }"\r\n                  type="text"\r\n                  v-validate="\'required|numeric\'"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group row">\r\n              <label class="col-sm-4 col-form-label"\r\n                >Tiền[{{ !errors.has("tien") }}]</label\r\n              >\r\n              <div class="col-sm-8">\r\n                <input\r\n                  name="tien"\r\n                  readonly\r\n                  v-model="sel.tien"\r\n                  :class="{\r\n                    \'form-control\': true,\r\n                    \'ko-hop-le\': errors.has(\'tien\'),\r\n                  }"\r\n                  type="text"\r\n                  v-validate="\'required|numeric\'"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div class="form-group row">\r\n              <label class="col-sm-4 col-form-label"\r\n                >Bàn[{{ !errors.has("banid") }}]</label\r\n              >\r\n              <div class="col-sm-8">\r\n                <v-select\r\n                  :class="{ \'ko-hop-le-select2\': errors.has(\'banid\') }"\r\n                  v-validate="\'required\'"\r\n                  @input="onMonChange()"\r\n                  name="banid"\r\n                  v-model="sel.banid"\r\n                  :reduce="(option) => option.id"\r\n                  :options="\r\n                    bans.map((x) => ({\r\n                      id: x.id,\r\n                      label: `${x.id} - ${x.tenban}`,\r\n                    }))\r\n                  "\r\n                />\r\n              </div>\r\n            </div>\r\n--\x3e\r\n\r\n\r\n            <button type="submit" class="btn mr-1">Save</button>\r\n            <button type="button" class="btn" @click="hideModal()">\r\n              Cancel\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </b-modal>\r\n      \r\n\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {TabulatorFull as Tabulator} from \'tabulator-tables\';\r\nimport $ from "jquery";\r\nimport axios from \'axios\';\r\n\r\nimport VeeValidate from "vee-validate";\r\nimport Vue from "vue";\r\nVue.use(VeeValidate, {\r\n  classes: true,\r\n});\r\n\r\n\r\n\r\nexport default {\r\n  name: \'Ban\',\r\n  components: {\r\n  },\r\n  data(){\r\n    return {\r\n      msg:"thuc 101",\r\n      tabulator: null, //variable to hold your table\r\n      tableData: [], //data for table to display\r\n\r\n      msg:"",\r\n      sel:{},\r\n      title:"",\r\n    }\r\n  },\r\n  mounted(){\r\n      let that=this;\r\n      this.tabulator = new Tabulator(this.$refs.table, {\r\n        pagination:true, //enable pagination\r\n        paginationMode:"remote", //enable remote pagination\r\n        ajaxSorting:true,\r\n        ajaxURL:"/api/Ban/GetPage", //set url for ajax request\r\n        ajaxFiltering:true,\r\n        filterMode:"remote", //send filter data to the server instead of processing locally\r\n        sortMode:"remote",\r\n        ajaxParams:{token:"ABC123"}, //set any standard parameters to pass with the request\r\n        paginationSize:2, //optional parameter to request a certain number of rows per page\r\n        paginationInitialPage:1, //optional parameter to set the initial page to load    \r\n        paginationSizeSelector: [5, 10, 20, 30, 50],\r\n        height:$(window).innerHeight()-400,//\'200px\',//$(window).innerHeight()\r\n        layout:"fitData",//layout:"fitDataFill",//layout:"fitColumns",\r\n        ajaxRequesting:function(url, params){\r\n          that.msg=`${url} - ` + JSON.stringify(params);\r\n        },\r\n        index:"Id",\r\n        //autoColumns:true,\r\n        columns:[                 //define the table columns\r\n          {\r\n            title: "STT",\r\n            formatter: "rownum",\r\n            headerHozAlign: "center",\r\n            hozAlign: "center",\r\n          },\r\n          {\r\n              title: "Cmd",\r\n              headerHozAlign: "center",\r\n              hozAlign: "center",\r\n              headerSort: false,\r\n              width: 90,\r\n              formatter: function (cell, formatterParams, onRendered) {\r\n                onRendered(function () {\r\n                  $(cell.getElement())\r\n                    .find("#edit")\r\n                    .on("click", cell.getRow(), that.onEdit);\r\n                  $(cell.getElement())\r\n                    .find("#del")\r\n                    .on("click", cell.getRow(), that.onDel);\r\n                });\r\n                let $div = $("<div>");\r\n                $div.append(\r\n                  $("<button>", { text: "Edit", class: "mr-1" }).attr("id","edit")\r\n                );\r\n                $div.append(\r\n                  $("<button>", { text: "Del", class: "mr-1" }).attr("id", "del")\r\n                );\r\n                return $div[0];\r\n              },\r\n          },\r\n          {\r\n            title:"Id", \r\n            field:"Id", \r\n            width:80,\r\n            headerHozAlign: "center",\r\n            hozAlign: "center",\r\n            headerFilter:true\r\n          },\r\n          {\r\n            title:"Name", \r\n            field:"Name", \r\n            //headerFilter: true,\r\n            headerFilter:"input",\r\n            width:200,\r\n            headerHozAlign: "center",\r\n            hozAlign: "left",\r\n          },\r\n        ],\r\n      });\r\n      this.tabulator.on("dataLoaded", function(data){\r\n        //that.msg={cmd:"dataLoaded",data:data};\r\n        let $tabu=$(that.$refs.table);\r\n        let $span = $("<span id=\'total\' class=\'mr-1\'>").text("[total]");\r\n        if($tabu.find(".tabulator-footer-contents").find("span#total").length==0){\r\n          $tabu.find(".tabulator-footer-contents span.tabulator-paginator").prepend($span);\r\n        }else{\r\n          $tabu.find(".tabulator-footer-contents").find("span#total").text(`[${new Date().getTime()}]`);\r\n        }\r\n      });\r\n      this.tabulator.on("pageLoaded", function(pageno){\r\n      });      \r\n  },\r\n  watch: {\r\n    tableData: {\r\n      handler: function (newData) {\r\n        this.tabulator.replaceData(newData)\r\n      },\r\n      deep: true\r\n    }\r\n  },  \r\n  created(){\r\n  },\r\n  methods:{\r\n    onDataLoaded(data){\r\n      let ar=[];\r\n      data.forEach((x,i)=>{\r\n        ar.push({x:x.id});\r\n      })\r\n      let curPage= this.tabulator.getPage();\r\n      this.msg={ar:ar,curPage:curPage};\r\n    },\r\n    onAddModal() {\r\n      let r={\r\n        Id:0,\r\n        Name:"Thuc 101",\r\n      }\r\n      this.sel=JSON.parse(JSON.stringify(r));\r\n      this.title="Add Bàn";\r\n      this.showModal();\r\n    },\r\n\r\n    onSaveModal() {\r\n      this.$validator.validateAll().then((result) => {\r\n        if (!result) {\r\n          this.toast("Không hợp lệ");\r\n          return;\r\n        }\r\n        let r=JSON.parse(JSON.stringify(this.sel));\r\n        //let ngay = moment(r.ngay, "DD/MM/YYYY").format("YYYY-MM-DD");\r\n        //r.ngay = ngay;\r\n        //this.toast(JSON.stringify(r)); //alert(JSON.stringify(r));\r\n        this.Save(r).then((res) => {\r\n          if (res.data.kq == "ok") {\r\n            this.toast(res.data.msg);\r\n            this.hideModal();\r\n            this.setPage(this.getPage());\r\n          } else {\r\n            this.toast(res.data.msg);\r\n          }\r\n        });\r\n      });\r\n    },\r\n    async Save(r) {\r\n      return await axios.post(`/api/Ban/Save`, r).catch((err) => {\r\n        console.log(err);\r\n      });\r\n    },\r\n    async Del(id) {\r\n      return await axios\r\n        .get(`/api/Ban/Delete?id=${id}`)\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    },\r\n\r\n\r\n    async getById(id) {\r\n      return await axios.get(`/api/Ban/GetById?id=${id}`).catch((err) => {\r\n        console.log(err);\r\n      });\r\n    },\r\n\r\n\r\n\r\n    onDel(e){\r\n      // let row = e.data;\r\n      // let id = row.getIndex();\r\n      // let data=row.getData();\r\n      // this.msg={cmd:"del",id:id,data:data}\r\n\r\n      let row = e.data;\r\n      let id = row.getIndex();\r\n      this.Del(id).then((res) => {\r\n        if (res.data.kq == "ok") {\r\n          if (this.getData().length != 1) {\r\n            this.setPage(this.getPage());\r\n          } else {\r\n            this.setPage(this.getPage() - 1);\r\n          }\r\n        }\r\n        this.toast(res.data.msg);\r\n      });\r\n\r\n\r\n\r\n    },\r\n    onEdit(e){\r\n      // let row = e.data;\r\n      // let id = row.getIndex();\r\n      // let data=row.getData();\r\n      // this.msg={cmd:"edit",id:id,data:data}\r\n\r\n      let row = e.data;\r\n      let id = row.getIndex();\r\n      this.getById(id).then(res=>{\r\n        this.sel=res.data;\r\n        //$(this.$refs["my-modal"]).attr("title","helllsfsfsf");\r\n        this.title="Edit Bàn";\r\n        this.showModal();\r\n      })\r\n\r\n\r\n\r\n    },  \r\n    getData() {\r\n      return this.tabulator.getData();\r\n    },\r\n    \r\n    getPage() {\r\n      return this.tabulator.getPage();\r\n    },\r\n    setPage(_page) {\r\n      this.tabulator.setPage(_page);\r\n    },\r\n    \r\n    toast(msg, variant = null) {\r\n      this.$bvToast.toast(msg, {\r\n        title: `Information`,\r\n        variant: variant,\r\n        solid: true,\r\n      });\r\n    },\r\n\r\n\r\n    showModal() {\r\n      this.$refs["my-modal"].show();\r\n    },\r\n    hideModal() {\r\n      this.$refs["my-modal"].hide();\r\n    },\r\n\r\n\r\n\r\n  }\r\n}\r\n<\/script>\r\n<style lang="scss">\r\n  $textSize: 8.5px; //14px !default; //table text size\r\n  @import "~tabulator-tables/src/scss/tabulator.scss";\r\n  .tabulator-col-title {\r\n    text-align: center;\r\n  }\r\n  .tabulator .tabulator-footer .tabulator-page.active {\r\n    background-color: greenyellow !important;\r\n    color: blue !important;\r\n  }\r\n  .select2,\r\n  .select2-selection {\r\n    width: 100% !important;\r\n  }\r\n  .select2-container .select2-selection--single {\r\n    height: 27px;\r\n  }\r\n  .select2-container--default .select2-selection--single .select2-selection__rendered {\r\n    color: #444;\r\n    line-height: 26px;\r\n  }\r\n  .datepicker td,\r\n  th {\r\n    text-align: center;\r\n    padding: 0px 6px;\r\n    font-size: 10px;\r\n  }\r\n  .col-4 input {\r\n    margin-bottom: 1px;\r\n  }\r\n  .my-invalid .select2-container {\r\n    border: 1px solid red;\r\n    border-radius: 5px;\r\n  }\r\n  .form-group {\r\n    margin-bottom: 0.3rem;\r\n  }\r\n  .col-form-label {\r\n    padding-top: calc(0.375rem + 1px);\r\n    padding-bottom: calc(0.375rem + 1px);\r\n    margin-bottom: 0;\r\n    font-size: inherit;\r\n    line-height: 1.5;\r\n    font-weight: bold;\r\n  }\r\n  \r\n  .vs__dropdown-toggle {\r\n    -webkit-appearance: none;\r\n    -moz-appearance: none;\r\n    appearance: none;\r\n    background: none;\r\n    border: var(--vs-border-width) var(--vs-border-style) var(--vs-border-color);\r\n    border-radius: var(--vs-border-radius);\r\n    display: flex;\r\n    padding: 0 0 0px;\r\n    white-space: normal;\r\n    /*border: 1px solid red;*/\r\n  }\r\n  .ko-hop-le-select2 {\r\n    border: 1px solid red;\r\n    border-radius: 10px;\r\n  }\r\n  .ko-hop-le{\r\n    border: 1px solid red;\r\n    border-radius: 10px;\r\n  }\r\n  </style>\r\n  \r\n'},23796:function(r,n,t){function e(r,n,t){return n in r?Object.defineProperty(r,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[n]=t,r}t.d(n,{Z:function(){return e}})}}]);
//# sourceMappingURL=3181-legacy.9fcf0dd0.js.map